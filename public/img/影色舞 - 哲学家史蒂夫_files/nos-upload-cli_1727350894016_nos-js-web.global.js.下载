"use strict";function _array_like_to_array(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _array_with_holes(e){if(Array.isArray(e))return e}function _array_without_holes(e){if(Array.isArray(e))return _array_like_to_array(e)}function _assert_this_initialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function asyncGeneratorStep(e,t,r,n,a,o,i){try{var s=e[o](i),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}function _async_to_generator(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){asyncGeneratorStep(o,n,a,i,s,"next",e)}function s(e){asyncGeneratorStep(o,n,a,i,s,"throw",e)}i(void 0)}))}}function _call_super(e,t,r){return t=_get_prototype_of(t),_possible_constructor_return(e,_is_native_reflect_construct()?Reflect.construct(t,r||[],_get_prototype_of(e).constructor):t.apply(e,r))}function _class_call_check(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _construct(e,t,r){return _construct=_is_native_reflect_construct()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var a=new(Function.bind.apply(e,n));return r&&_set_prototype_of(a,r.prototype),a},_construct.apply(null,arguments)}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _create_class(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _define_property(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _get(e,t,r){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_super_prop_base(e,t);if(n){var a=Object.getOwnPropertyDescriptor(n,t);return a.get?a.get.call(r||e):a.value}},_get(e,t,r||e)}function _get_prototype_of(e){return _get_prototype_of=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_get_prototype_of(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_set_prototype_of(e,t)}function _instanceof(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function _is_native_function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function _iterable_to_array(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _iterable_to_array_limit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){s=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(s)throw a}}return o}}function _non_iterable_rest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _object_spread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_define_property(e,t,r[t])}))}return e}function _possible_constructor_return(e,t){return!t||"object"!==_type_of(t)&&"function"!=typeof t?_assert_this_initialized(e):t}function _set_prototype_of(e,t){return _set_prototype_of=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_set_prototype_of(e,t)}function _sliced_to_array(e,t){return _array_with_holes(e)||_iterable_to_array_limit(e,t)||_unsupported_iterable_to_array(e,t)||_non_iterable_rest()}function _super_prop_base(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_get_prototype_of(e)););return e}function _to_array(e){return _array_with_holes(e)||_iterable_to_array(e)||_unsupported_iterable_to_array(e)||_non_iterable_rest()}function _to_consumable_array(e){return _array_without_holes(e)||_iterable_to_array(e)||_unsupported_iterable_to_array(e)||_non_iterable_spread()}function _type_of(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function _unsupported_iterable_to_array(e,t){if(e){if("string"==typeof e)return _array_like_to_array(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_array_like_to_array(e,t):void 0}}function _wrap_native_super(e){var t="function"==typeof Map?new Map:void 0;return _wrap_native_super=function(e){if(null===e||!_is_native_function(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return _construct(e,arguments,_get_prototype_of(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_set_prototype_of(r,e)},_wrap_native_super(e)}function _is_native_reflect_construct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_is_native_reflect_construct=function(){return!!e})()}function _ts_generator(e,t){var r,n,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var NOS_JS_WEB=function(){var e=function(e,t,r){var n=t[e];"function"==typeof n&&n.apply(t,r),"function"==typeof t.emit&&t.emit(e,r)},t=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r]},r=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r]},n=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r]},a=function(e,t){return e.replace(/\{(\w+)\}/g,(function(e,r){return t[r]||""}))},o=function(e,t,r){var n=Math.min(t+r,e.size);return e.slice(t,n)},i=function(e){var t=ge(e),r=t.operateType,n=t.query;if(_e[r])return new _e[r](n)},s=function(e,t){for(var r=e.length-1;r>=0;r--)if(t(e[r],r,e))return e[r]},u=function(){var e="undefined"!=typeof window?window:null;if(!e||void 0===e.XMLHttpRequest)throw new Error("XMLHttpRequest not support");return new e.XMLHttpRequest},l=function(e,t){"function"==typeof t&&t(e)},c=function(e,t){return function(){var r=e.xhr;4===r.readyState||e.end||(e.end=!0,r.abort(),e.aborted=!0,l(e,t))}},f=function(e){var t=e.url,r=e.method,n=e.body,a=e.headers,o=void 0===a?{}:a,i=e.async,s=void 0===i||i,f=e.timeout,d=e.responseType,p=void 0===d?"json":d,h=e.onSuccess,_=e.onError,g=u(),v={xhr:g,url:t,end:!1,aborted:!1,abort:y((function(){}),"abort"),send:y((function(){}),"send")};return v.abort=c(v,_),g.open(r,t,s),p&&(g.responseType=p),s&&f&&f>0&&(g.timeout=f),Object.keys(o).forEach((function(e){"content-type"===e.toLowerCase()&&"[object FormData]"===Object.prototype.toString.call(n)||g.setRequestHeader(e,o[e])})),g.onreadystatechange=function(){4===g.readyState?g.status>=200&&g.status<300?l(v,h):l(v,_):g.readyState<2&&g.status>0&&l(v,_)},v.send=function(){g.send(n)},v},d=Object.create,p=Object.defineProperty,h=Object.getOwnPropertyDescriptor,_=Object.getOwnPropertyNames,g=Object.getPrototypeOf,v=Object.prototype.hasOwnProperty,y=function(e,t){return p(e,"name",{value:t,configurable:!0})},m=function(e,t){return function(){return t||(0,e[_(e)[0]])((t={exports:{}}).exports,t),t.exports}},b=function(e,t,r,n){if(t&&"object"===(void 0===t?"undefined":_type_of(t))||"function"==typeof t){var a=!0,o=!1,i=void 0;try{for(var s,u=function(){var a=s.value;v.call(e,a)||a===r||p(e,a,{get:function(){return t[a]},enumerable:!(n=h(t,a))||n.enumerable})},l=_(t)[Symbol.iterator]();!(a=(s=l.next()).done);a=!0)u()}catch(e){o=!0,i=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw i}}}return e},N=function(e,t,r){return r=null!=e?d(g(e)):{},b(!t&&e&&e.__esModule?r:p(r,"default",{value:e,enumerable:!0}),e)},O=function(e,t,r){return function(e,t,r){return t in e?p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r}(e,"symbol"!==(void 0===t?"undefined":_type_of(t))?t+"":t,r)},k=m({"../../node_modules/.pnpm/spark-md5@3.0.2/node_modules/spark-md5/spark-md5.js":function(e,t){!function(r){if("object"===(void 0===e?"undefined":_type_of(e)))t.exports=r();else if("function"==typeof define&&define.amd)define(r);else{var n;try{n=window}catch(e){n=self}n.SparkMD5=r()}}((function(e){var t=y((function(e,t){return e+t&4294967295}),"add32"),r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function n(e,t){var r=e[0],n=e[1],a=e[2],o=e[3];n=((n+=((a=((a+=((o=((o+=((r=((r+=(n&a|~n&o)+t[0]-680876936|0)<<7|r>>>25)+n|0)&n|~r&a)+t[1]-389564586|0)<<12|o>>>20)+r|0)&r|~o&n)+t[2]+606105819|0)<<17|a>>>15)+o|0)&o|~a&r)+t[3]-1044525330|0)<<22|n>>>10)+a|0,n=((n+=((a=((a+=((o=((o+=((r=((r+=(n&a|~n&o)+t[4]-176418897|0)<<7|r>>>25)+n|0)&n|~r&a)+t[5]+1200080426|0)<<12|o>>>20)+r|0)&r|~o&n)+t[6]-1473231341|0)<<17|a>>>15)+o|0)&o|~a&r)+t[7]-45705983|0)<<22|n>>>10)+a|0,n=((n+=((a=((a+=((o=((o+=((r=((r+=(n&a|~n&o)+t[8]+1770035416|0)<<7|r>>>25)+n|0)&n|~r&a)+t[9]-1958414417|0)<<12|o>>>20)+r|0)&r|~o&n)+t[10]-42063|0)<<17|a>>>15)+o|0)&o|~a&r)+t[11]-1990404162|0)<<22|n>>>10)+a|0,n=((n+=((a=((a+=((o=((o+=((r=((r+=(n&a|~n&o)+t[12]+1804603682|0)<<7|r>>>25)+n|0)&n|~r&a)+t[13]-40341101|0)<<12|o>>>20)+r|0)&r|~o&n)+t[14]-1502002290|0)<<17|a>>>15)+o|0)&o|~a&r)+t[15]+1236535329|0)<<22|n>>>10)+a|0,n=((n+=((a=((a+=((o=((o+=((r=((r+=(n&o|a&~o)+t[1]-165796510|0)<<5|r>>>27)+n|0)&a|n&~a)+t[6]-1069501632|0)<<9|o>>>23)+r|0)&n|r&~n)+t[11]+643717713|0)<<14|a>>>18)+o|0)&r|o&~r)+t[0]-373897302|0)<<20|n>>>12)+a|0,n=((n+=((a=((a+=((o=((o+=((r=((r+=(n&o|a&~o)+t[5]-701558691|0)<<5|r>>>27)+n|0)&a|n&~a)+t[10]+38016083|0)<<9|o>>>23)+r|0)&n|r&~n)+t[15]-660478335|0)<<14|a>>>18)+o|0)&r|o&~r)+t[4]-405537848|0)<<20|n>>>12)+a|0,n=((n+=((a=((a+=((o=((o+=((r=((r+=(n&o|a&~o)+t[9]+568446438|0)<<5|r>>>27)+n|0)&a|n&~a)+t[14]-1019803690|0)<<9|o>>>23)+r|0)&n|r&~n)+t[3]-187363961|0)<<14|a>>>18)+o|0)&r|o&~r)+t[8]+1163531501|0)<<20|n>>>12)+a|0,n=((n+=((a=((a+=((o=((o+=((r=((r+=(n&o|a&~o)+t[13]-1444681467|0)<<5|r>>>27)+n|0)&a|n&~a)+t[2]-51403784|0)<<9|o>>>23)+r|0)&n|r&~n)+t[7]+1735328473|0)<<14|a>>>18)+o|0)&r|o&~r)+t[12]-1926607734|0)<<20|n>>>12)+a|0,n=((n+=((a=((a+=((o=((o+=((r=((r+=(n^a^o)+t[5]-378558|0)<<4|r>>>28)+n|0)^n^a)+t[8]-2022574463|0)<<11|o>>>21)+r|0)^r^n)+t[11]+1839030562|0)<<16|a>>>16)+o|0)^o^r)+t[14]-35309556|0)<<23|n>>>9)+a|0,n=((n+=((a=((a+=((o=((o+=((r=((r+=(n^a^o)+t[1]-1530992060|0)<<4|r>>>28)+n|0)^n^a)+t[4]+1272893353|0)<<11|o>>>21)+r|0)^r^n)+t[7]-155497632|0)<<16|a>>>16)+o|0)^o^r)+t[10]-1094730640|0)<<23|n>>>9)+a|0,n=((n+=((a=((a+=((o=((o+=((r=((r+=(n^a^o)+t[13]+681279174|0)<<4|r>>>28)+n|0)^n^a)+t[0]-358537222|0)<<11|o>>>21)+r|0)^r^n)+t[3]-722521979|0)<<16|a>>>16)+o|0)^o^r)+t[6]+76029189|0)<<23|n>>>9)+a|0,n=((n+=((a=((a+=((o=((o+=((r=((r+=(n^a^o)+t[9]-640364487|0)<<4|r>>>28)+n|0)^n^a)+t[12]-421815835|0)<<11|o>>>21)+r|0)^r^n)+t[15]+530742520|0)<<16|a>>>16)+o|0)^o^r)+t[2]-995338651|0)<<23|n>>>9)+a|0,n=((n+=((o=((o+=(n^((r=((r+=(a^(n|~o))+t[0]-198630844|0)<<6|r>>>26)+n|0)|~a))+t[7]+1126891415|0)<<10|o>>>22)+r|0)^((a=((a+=(r^(o|~n))+t[14]-1416354905|0)<<15|a>>>17)+o|0)|~r))+t[5]-57434055|0)<<21|n>>>11)+a|0,n=((n+=((o=((o+=(n^((r=((r+=(a^(n|~o))+t[12]+1700485571|0)<<6|r>>>26)+n|0)|~a))+t[3]-1894986606|0)<<10|o>>>22)+r|0)^((a=((a+=(r^(o|~n))+t[10]-1051523|0)<<15|a>>>17)+o|0)|~r))+t[1]-2054922799|0)<<21|n>>>11)+a|0,n=((n+=((o=((o+=(n^((r=((r+=(a^(n|~o))+t[8]+1873313359|0)<<6|r>>>26)+n|0)|~a))+t[15]-30611744|0)<<10|o>>>22)+r|0)^((a=((a+=(r^(o|~n))+t[6]-1560198380|0)<<15|a>>>17)+o|0)|~r))+t[13]+1309151649|0)<<21|n>>>11)+a|0,n=((n+=((o=((o+=(n^((r=((r+=(a^(n|~o))+t[4]-145523070|0)<<6|r>>>26)+n|0)|~a))+t[11]-1120210379|0)<<10|o>>>22)+r|0)^((a=((a+=(r^(o|~n))+t[2]+718787259|0)<<15|a>>>17)+o|0)|~r))+t[9]-343485551|0)<<21|n>>>11)+a|0,e[0]=r+e[0]|0,e[1]=n+e[1]|0,e[2]=a+e[2]|0,e[3]=o+e[3]|0}function a(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}function o(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return r}function i(e){var t,r,o,i,s,u,l=e.length,c=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=l;t+=64)n(c,a(e.substring(t-64,t)));for(r=(e=e.substring(t-64)).length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<r;t+=1)o[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(o[t>>2]|=128<<(t%4<<3),t>55)for(n(c,o),t=0;t<16;t+=1)o[t]=0;return i=(i=8*l).toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(i[2],16),u=parseInt(i[1],16)||0,o[14]=s,o[15]=u,n(c,o),c}function s(e){var t,r,a,i,s,u,l=e.length,c=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=l;t+=64)n(c,o(e.subarray(t-64,t)));for(r=(e=t-64<l?e.subarray(t-64):new Uint8Array(0)).length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<r;t+=1)a[t>>2]|=e[t]<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(n(c,a),t=0;t<16;t+=1)a[t]=0;return i=(i=8*l).toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(i[2],16),u=parseInt(i[1],16)||0,a[14]=s,a[15]=u,n(c,a),c}function u(e){var t,n="";for(t=0;t<4;t+=1)n+=r[e>>8*t+4&15]+r[e>>8*t&15];return n}function l(e){var t;for(t=0;t<e.length;t+=1)e[t]=u(e[t]);return e.join("")}function c(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),e}function f(e,t){var r,n=e.length,a=new ArrayBuffer(n),o=new Uint8Array(a);for(r=0;r<n;r+=1)o[r]=e.charCodeAt(r);return t?o:a}function d(e){return String.fromCharCode.apply(null,new Uint8Array(e))}function p(e,t,r){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e)),n.set(new Uint8Array(t),e.byteLength),r?n:n.buffer}function h(e){var t,r=[],n=e.length;for(t=0;t<n-1;t+=2)r.push(parseInt(e.substr(t,2),16));return String.fromCharCode.apply(String,r)}function _(){this.reset()}return y((function(e,r,n,a,o,i){return r=t(t(r,e),t(a,i)),t(r<<o|r>>>32-o,n)}),"cmn"),y(n,"md5cycle"),y(a,"md5blk"),y(o,"md5blk_array"),y(i,"md51"),y(s,"md51_array"),y(u,"rhex"),y(l,"hex"),"5d41402abc4b2a76b9719d911017c592"!==l(i("hello"))&&(t=y((function(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}),"add32")),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function t(e,t){return(e=0|e||0)<0?Math.max(e+t,0):Math.min(e,t)}y(t,"clamp"),ArrayBuffer.prototype.slice=function(r,n){var a,o,i,s,u=this.byteLength,l=t(r,u),c=u;return n!==e&&(c=t(n,u)),l>c?new ArrayBuffer(0):(a=c-l,o=new ArrayBuffer(a),i=new Uint8Array(o),s=new Uint8Array(this,l,a),i.set(s),o)}}(),y(c,"toUtf8"),y(f,"utf8Str2ArrayBuffer"),y(d,"arrayBuffer2Utf8Str"),y(p,"concatenateArrayBuffers"),y(h,"hexToBinaryString"),y(_,"SparkMD5"),_.prototype.append=function(e){return this.appendBinary(c(e)),this},_.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var t,r=this._buff.length;for(t=64;t<=r;t+=64)n(this._hash,a(this._buff.substring(t-64,t)));return this._buff=this._buff.substring(t-64),this},_.prototype.end=function(e){var t,r,n=this._buff,a=n.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<a;t+=1)o[t>>2]|=n.charCodeAt(t)<<(t%4<<3);return this._finish(o,a),r=l(this._hash),e&&(r=h(r)),this.reset(),r},_.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},_.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},_.prototype.setState=function(e){return this._buff=e.buff,this._length=e.length,this._hash=e.hash,this},_.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},_.prototype._finish=function(e,t){var r,a,o,i=t;if(e[i>>2]|=128<<(i%4<<3),i>55)for(n(this._hash,e),i=0;i<16;i+=1)e[i]=0;r=(r=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(r[2],16),o=parseInt(r[1],16)||0,e[14]=a,e[15]=o,n(this._hash,e)},_.hash=function(e,t){return _.hashBinary(c(e),t)},_.hashBinary=function(e,t){var r=l(i(e));return t?h(r):r},_.ArrayBuffer=function(){this.reset()},_.ArrayBuffer.prototype.append=function(e){var t,r=p(this._buff.buffer,e,!0),a=r.length;for(this._length+=e.byteLength,t=64;t<=a;t+=64)n(this._hash,o(r.subarray(t-64,t)));return this._buff=t-64<a?new Uint8Array(r.buffer.slice(t-64)):new Uint8Array(0),this},_.ArrayBuffer.prototype.end=function(e){var t,r,n=this._buff,a=n.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<a;t+=1)o[t>>2]|=n[t]<<(t%4<<3);return this._finish(o,a),r=l(this._hash),e&&(r=h(r)),this.reset(),r},_.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},_.ArrayBuffer.prototype.getState=function(){var e=_.prototype.getState.call(this);return e.buff=d(e.buff),e},_.ArrayBuffer.prototype.setState=function(e){return e.buff=f(e.buff,!0),_.prototype.setState.call(this,e)},_.ArrayBuffer.prototype.destroy=_.prototype.destroy,_.ArrayBuffer.prototype._finish=_.prototype._finish,_.ArrayBuffer.hash=function(e,t){var r=l(s(new Uint8Array(e)));return t?h(r):r},_}))}}),A=m({"../../node_modules/.pnpm/fast-xml-parser@3.19.0/node_modules/fast-xml-parser/src/util.js":function(e){var t=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",r="["+t+"]["+(t+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040")+"]*",n=new RegExp("^"+r+"$"),a=y((function(e,t){for(var r=[],n=t.exec(e);n;){for(var a=[],o=n.length,i=0;i<o;i++)a.push(n[i]);r.push(a),n=t.exec(e)}return r}),"getAllMatches"),o=y((function(e){var t=n.exec(e);return!(null==t)}),"isName");e.isExist=function(e){return void 0!==e},e.isEmptyObject=function(e){return 0===Object.keys(e).length},e.merge=function(e,t,r){if(t)for(var n=Object.keys(t),a=n.length,o=0;o<a;o++)e[n[o]]="strict"===r?[t[n[o]]]:t[n[o]]},e.getValue=function(t){return e.isExist(t)?t:""},e.buildOptions=function(e,t,r){var n={};if(!e)return t;for(var a=0;a<r.length;a++)void 0!==e[r[a]]?n[r[a]]=e[r[a]]:n[r[a]]=t[r[a]];return n},e.isTagNameInArrayMode=function(e,t,r){return!1!==t&&(_instanceof(t,RegExp)?t.test(e):"function"==typeof t?!!t(e,r):"strict"===t)},e.isName=o,e.getAllMatches=a,e.nameRegexp=r}}),E=m({"../../node_modules/.pnpm/fast-xml-parser@3.19.0/node_modules/fast-xml-parser/src/node2json.js":function(e){var t=A(),r=y((function(e,n,a){var o={};if((!e.child||t.isEmptyObject(e.child))&&(!e.attrsMap||t.isEmptyObject(e.attrsMap)))return t.isExist(e.val)?e.val:"";if(t.isExist(e.val)&&("string"!=typeof e.val||""!==e.val&&e.val!==n.cdataPositionChar)){var i=t.isTagNameInArrayMode(e.tagname,n.arrayMode,a);o[n.textNodeName]=i?[e.val]:e.val}t.merge(o,e.attrsMap,n.arrayMode);for(var s=Object.keys(e.child),u=0;u<s.length;u++){var l=s[u];if(e.child[l]&&e.child[l].length>1)for(var c in o[l]=[],e.child[l])e.child[l].hasOwnProperty(c)&&o[l].push(r(e.child[l][c],n,l));else{var f=r(e.child[l][0],n,l),d=!0===n.arrayMode&&"object"===(void 0===f?"undefined":_type_of(f))||t.isTagNameInArrayMode(l,n.arrayMode,a);o[l]=d?[f]:f}}return o}),"convertToJson");e.convertToJson=r}}),C=m({"../../node_modules/.pnpm/fast-xml-parser@3.19.0/node_modules/fast-xml-parser/src/xmlNode.js":function(e,t){t.exports=function(e,t,r){this.tagname=e,this.parent=t,this.child={},this.attrsMap={},this.val=r,this.addChild=function(e){Array.isArray(this.child[e.tagname])?this.child[e.tagname].push(e):this.child[e.tagname]=[e]}}}}),T=m({"../../node_modules/.pnpm/fast-xml-parser@3.19.0/node_modules/fast-xml-parser/src/xmlstr2xmlnode.js":function(e){var t=A(),r=A().buildOptions,n=C();"<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,t.nameRegexp);!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);var a={attributeNamePrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!0,ignoreNameSpace:!1,allowBooleanAttributes:!1,parseNodeValue:!0,parseAttributeValue:!1,arrayMode:!1,trimValues:!0,cdataTagName:!1,cdataPositionChar:"\\c",tagValueProcessor:y((function(e,t){return e}),"tagValueProcessor"),attrValueProcessor:y((function(e,t){return e}),"attrValueProcessor"),stopNodes:[]};e.defaultOptions=a;var o=["attributeNamePrefix","attrNodeName","textNodeName","ignoreAttributes","ignoreNameSpace","allowBooleanAttributes","parseNodeValue","parseAttributeValue","arrayMode","trimValues","cdataTagName","cdataPositionChar","tagValueProcessor","attrValueProcessor","parseTrueNumberOnly","stopNodes"];function i(e,t,r){return t&&(r.trimValues&&(t=t.trim()),t=u(t=r.tagValueProcessor(t,e),r.parseNodeValue,r.parseTrueNumberOnly)),t}function s(e,t){if(t.ignoreNameSpace){var r=e.split(":"),n="/"===e.charAt(0)?"/":"";if("xmlns"===r[0])return"";2===r.length&&(e=n+r[1])}return e}function u(e,r,n){var a;return r&&"string"==typeof e?(""===e.trim()||isNaN(e)?a="true"===e||"false"!==e&&e:(-1!==e.indexOf("0x")?a=Number.parseInt(e,16):-1!==e.indexOf(".")?(a=Number.parseFloat(e),e=e.replace(/\.?0+$/,"")):a=Number.parseInt(e,10),n&&(a=String(a)===e?a:e)),a):t.isExist(e)?e:""}e.props=o,y(i,"processTagValue"),y(s,"resolveNameSpace"),y(u,"parseValue");var l=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])(.*?)\\3)?","g");function c(e,r){if(!r.ignoreAttributes&&"string"==typeof e){e=e.replace(/\r?\n/g," ");for(var n=t.getAllMatches(e,l),a=n.length,o={},i=0;i<a;i++){var c=s(n[i][1],r);c.length&&(void 0!==n[i][4]?(r.trimValues&&(n[i][4]=n[i][4].trim()),n[i][4]=r.attrValueProcessor(n[i][4],c),o[r.attributeNamePrefix+c]=u(n[i][4],r.parseAttributeValue,r.parseTrueNumberOnly)):r.allowBooleanAttributes&&(o[r.attributeNamePrefix+c]=!0))}if(!Object.keys(o).length)return;if(r.attrNodeName){var f={};return f[r.attrNodeName]=o,f}return o}}y(c,"buildAttributesMap");var f=y((function(e,s){e=e.replace(/\r\n?/g,"\n"),s=r(s,a,o);for(var u=new n("!xml"),l=u,f="",h=0;h<e.length;h++){if("<"===e[h])if("/"===e[h+1]){var _=p(e,">",h,"Closing Tag is not closed."),g=e.substring(h+2,_).trim();if(s.ignoreNameSpace){var v=g.indexOf(":");-1!==v&&(g=g.substr(v+1))}l&&(l.val?l.val=t.getValue(l.val)+""+i(g,f,s):l.val=i(g,f,s)),s.stopNodes.length&&s.stopNodes.includes(l.tagname)&&(l.child=[],null==l.attrsMap&&(l.attrsMap={}),l.val=e.substr(l.startIndex+1,h-l.startIndex-1)),l=l.parent,f="",h=_}else if("?"===e[h+1])h=p(e,"?>",h,"Pi Tag is not closed.");else if("!--"===e.substr(h+1,3))h=p(e,"--\x3e",h,"Comment is not closed.");else if("!D"===e.substr(h+1,2)){var y=p(e,">",h,"DOCTYPE is not closed.");h=e.substring(h,y).indexOf("[")>=0?e.indexOf("]>",h)+1:y}else if("!["===e.substr(h+1,2)){var m=p(e,"]]>",h,"CDATA is not closed.")-2,b=e.substring(h+9,m);if(f&&(l.val=t.getValue(l.val)+""+i(l.tagname,f,s),f=""),s.cdataTagName){var N=new n(s.cdataTagName,l,b);l.addChild(N),l.val=t.getValue(l.val)+s.cdataPositionChar,b&&(N.val=b)}else l.val=(l.val||"")+(b||"");h=m+2}else{var O=d(e,h+1),k=O.data,A=O.index,E=k.indexOf(" "),C=k,T=!0;if(-1!==E&&(C=k.substr(0,E).replace(/\s\s*$/,""),k=k.substr(E+1)),s.ignoreNameSpace){var w=C.indexOf(":");-1!==w&&(T=(C=C.substr(w+1))!==O.data.substr(w+1))}if(l&&f&&"!xml"!==l.tagname&&(l.val=t.getValue(l.val)+""+i(l.tagname,f,s)),k.length>0&&k.lastIndexOf("/")===k.length-1){k="/"===C[C.length-1]?C=C.substr(0,C.length-1):k.substr(0,k.length-1);var x=new n(C,l,"");C!==k&&(x.attrsMap=c(k,s)),l.addChild(x)}else{var P=new n(C,l);s.stopNodes.length&&s.stopNodes.includes(P.tagname)&&(P.startIndex=A),C!==k&&T&&(P.attrsMap=c(k,s)),l.addChild(P),l=P}f="",h=A}else f+=e[h]}return u}),"getTraversalObj");function d(e,t){for(var r,n="",a=t;a<e.length;a++){var o=e[a];if(r)o===r&&(r="");else if('"'===o||"'"===o)r=o;else{if(">"===o)return{data:n,index:a};"\t"===o&&(o=" ")}n+=o}}function p(e,t,r,n){var a=e.indexOf(t,r);if(-1===a)throw new Error(n);return a+t.length-1}y(d,"closingIndexForOpeningTag"),y(p,"findClosingIndex"),e.getTraversalObj=f}}),w=m({"../../node_modules/.pnpm/fast-xml-parser@3.19.0/node_modules/fast-xml-parser/src/validator.js":function(e){var t=A(),r={allowBooleanAttributes:!1},n=["allowBooleanAttributes"];function a(e,t){for(var r=t;t<e.length;t++)if("?"!=e[t]&&" "!=e[t]);else{var n=e.substr(r,t-r);if(t>5&&"xml"===n)return p("InvalidXml","XML declaration allowed only at the start of the document.",g(e,t));if("?"==e[t]&&">"==e[t+1]){t++;break}}return t}function o(e,t){if(e.length>t+5&&"-"===e[t+1]&&"-"===e[t+2]){for(t+=3;t<e.length;t++)if("-"===e[t]&&"-"===e[t+1]&&">"===e[t+2]){t+=2;break}}else if(e.length>t+8&&"D"===e[t+1]&&"O"===e[t+2]&&"C"===e[t+3]&&"T"===e[t+4]&&"Y"===e[t+5]&&"P"===e[t+6]&&"E"===e[t+7]){var r=1;for(t+=8;t<e.length;t++)if("<"===e[t])r++;else if(">"===e[t]&&0===--r)break}else if(e.length>t+9&&"["===e[t+1]&&"C"===e[t+2]&&"D"===e[t+3]&&"A"===e[t+4]&&"T"===e[t+5]&&"A"===e[t+6]&&"["===e[t+7])for(t+=8;t<e.length;t++)if("]"===e[t]&&"]"===e[t+1]&&">"===e[t+2]){t+=2;break}return t}e.validate=function(e,i){i=t.buildOptions(i,r,n);var s=[],l=!1,f=!1;"\ufeff"===e[0]&&(e=e.substr(1));for(var h=0;h<e.length;h++)if("<"===e[h]&&"?"===e[h+1]){if((h=a(e,h+=2)).err)return h}else{if("<"!==e[h]){if(" "===e[h]||"\t"===e[h]||"\n"===e[h]||"\r"===e[h])continue;return p("InvalidChar","char '"+e[h]+"' is not expected.",g(e,h))}if("!"===e[++h]){h=o(e,h);continue}var v=!1;"/"===e[h]&&(v=!0,h++);for(var y="";h<e.length&&">"!==e[h]&&" "!==e[h]&&"\t"!==e[h]&&"\n"!==e[h]&&"\r"!==e[h];h++)y+=e[h];if("/"===(y=y.trim())[y.length-1]&&(y=y.substring(0,y.length-1),h--),!_(y)){return p("InvalidTag",0===y.trim().length?"There is an unnecessary space between tag name and backward slash '</ ..'.":"Tag '"+y+"' is an invalid name.",g(e,h))}var m=u(e,h);if(!1===m)return p("InvalidAttr","Attributes for '"+y+"' have open quote.",g(e,h));var b=m.value;if(h=m.index,"/"===b[b.length-1]){var N=c(b=b.substring(0,b.length-1),i);if(!0!==N)return p(N.err.code,N.err.msg,g(e,h-b.length+N.err.line));l=!0}else if(v){if(!m.tagClosed)return p("InvalidTag","Closing tag '"+y+"' doesn't have proper closing.",g(e,h));if(b.trim().length>0)return p("InvalidTag","Closing tag '"+y+"' can't have attributes or invalid starting.",g(e,h));var O=s.pop();if(y!==O)return p("InvalidTag","Closing tag '"+O+"' is expected inplace of '"+y+"'.",g(e,h));0==s.length&&(f=!0)}else{var k=c(b,i);if(!0!==k)return p(k.err.code,k.err.msg,g(e,h-b.length+k.err.line));if(!0===f)return p("InvalidXml","Multiple possible root nodes found.",g(e,h));s.push(y),l=!0}for(h++;h<e.length;h++)if("<"===e[h]){if("!"===e[h+1]){h=o(e,++h);continue}if("?"!==e[h+1])break;if((h=a(e,++h)).err)return h}else if("&"===e[h]){var A=d(e,h);if(-1==A)return p("InvalidChar","char '&' is not expected.",g(e,h));h=A}"<"===e[h]&&h--}return l?!(s.length>0)||p("InvalidXml","Invalid '"+JSON.stringify(s,null,4).replace(/\r?\n/g,"")+"' found.",1):p("InvalidXml","Start tag expected.",1)},y(a,"readPI"),y(o,"readCommentAndCDATA");var i='"',s="'";function u(e,t){for(var r="",n="",a=!1;t<e.length;t++){if(e[t]===i||e[t]===s)if(""===n)n=e[t];else{if(n!==e[t])continue;n=""}else if(">"===e[t]&&""===n){a=!0;break}r+=e[t]}return""===n&&{value:r,index:t,tagClosed:a}}y(u,"readAttributeStr");var l=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function c(e,r){for(var n=t.getAllMatches(e,l),a={},o=0;o<n.length;o++){if(0===n[o][1].length)return p("InvalidAttr","Attribute '"+n[o][2]+"' has no space in starting.",v(e,n[o][0]));if(void 0===n[o][3]&&!r.allowBooleanAttributes)return p("InvalidAttr","boolean attribute '"+n[o][2]+"' is not allowed.",v(e,n[o][0]));var i=n[o][2];if(!h(i))return p("InvalidAttr","Attribute '"+i+"' is an invalid name.",v(e,n[o][0]));if(a.hasOwnProperty(i))return p("InvalidAttr","Attribute '"+i+"' is repeated.",v(e,n[o][0]));a[i]=1}return!0}function f(e,t){var r=/\d/;for("x"===e[t]&&(t++,r=/[\da-fA-F]/);t<e.length;t++){if(";"===e[t])return t;if(!e[t].match(r))break}return-1}function d(e,t){if(";"===e[++t])return-1;if("#"===e[t])return f(e,++t);for(var r=0;t<e.length;t++,r++)if(!(e[t].match(/\w/)&&r<20)){if(";"===e[t])break;return-1}return t}function p(e,t,r){return{err:{code:e,msg:t,line:r}}}function h(e){return t.isName(e)}function _(e){return t.isName(e)}function g(e,t){return e.substring(0,t).split(/\r?\n/).length}function v(e,t){return e.indexOf(t)+t.length}y(c,"validateAttributeString"),y(f,"validateNumberAmpersand"),y(d,"validateAmpersand"),y(p,"getErrorObject"),y(h,"validateAttrName"),y(_,"validateTagName"),y(g,"getLineNumberForPosition"),y(v,"getPositionFromMatch")}}),x=m({"../../node_modules/.pnpm/fast-xml-parser@3.19.0/node_modules/fast-xml-parser/src/nimndata.js":function(e){var t=y((function(e){return String.fromCharCode(e)}),"char"),r={nilChar:t(176),missingChar:t(201),nilPremitive:t(175),missingPremitive:t(200),emptyChar:t(178),emptyValue:t(177),boundryChar:t(179),objStart:t(198),arrStart:t(204),arrayEnd:t(185)},n=[r.nilChar,r.nilPremitive,r.missingChar,r.missingPremitive,r.boundryChar,r.emptyChar,r.emptyValue,r.arrayEnd,r.objStart,r.arrStart],a=y((function(e,t,n){if("string"==typeof t)return e&&e[0]&&void 0!==e[0].val?o(e[0].val,t):o(e,t);var s=u(e);if(!0===s){var l="";if(Array.isArray(t)){l+=r.arrStart;var c=t[0],f=e.length;if("string"==typeof c)for(var d=0;d<f;d++){var p=o(e[d].val,c);l=i(l,p)}else for(var h=0;h<f;h++){var _=a(e[h],c,n);l=i(l,_)}l+=r.arrayEnd}else{l+=r.objStart;var g=Object.keys(t);for(var v in Array.isArray(e)&&(e=e[0]),g){var y=g[v],m=void 0;m=!n.ignoreAttributes&&e.attrsMap&&e.attrsMap[y]?a(e.attrsMap[y],t[y],n):y===n.textNodeName?a(e.val,t[y],n):a(e.child[y],t[y],n),l=i(l,m)}}return l}return s}),"_e"),o=y((function(e){switch(e){case void 0:return r.missingPremitive;case null:return r.nilPremitive;case"":return r.emptyValue;default:return e}}),"getValue"),i=y((function(e,t){return s(t[0])||s(e[e.length-1])||(e+=r.boundryChar),e+t}),"processValue"),s=y((function(e){return-1!==n.indexOf(e)}),"isAppChar");function u(e){return void 0===e?r.missingChar:null===e?r.nilChar:!(e.child&&0===Object.keys(e.child).length&&(!e.attrsMap||0===Object.keys(e.attrsMap).length))||r.emptyChar}y(u,"hasData");var l=T(),c=A().buildOptions,f=y((function(e,t,r){return r=c(r,l.defaultOptions,l.props),a(e,t,r)}),"convert2nimn");e.convert2nimn=f}}),P=m({"../../node_modules/.pnpm/fast-xml-parser@3.19.0/node_modules/fast-xml-parser/src/node2json_str.js":function(e){var t=A(),r=A().buildOptions,n=T(),a=y((function(e,t){return(t=r(t,n.defaultOptions,n.props)).indentBy=t.indentBy||"",o(e,t,0)}),"convertToJsonString"),o=y((function(e,r,n){for(var a="{",s=Object.keys(e.child),u=0;u<s.length;u++){var l=s[u];if(e.child[l]&&e.child[l].length>1){for(var c in a+='"'+l+'" : [ ',e.child[l])a+=o(e.child[l][c],r)+" , ";a=a.substr(0,a.length-1)+" ] "}else a+='"'+l+'" : '+o(e.child[l][0],r)+" ,"}return t.merge(a,e.attrsMap),t.isEmptyObject(a)?t.isExist(e.val)?e.val:"":(t.isExist(e.val)&&("string"!=typeof e.val||""!==e.val&&e.val!==r.cdataPositionChar)&&(a+='"'+r.textNodeName+'" : '+i(e.val)),","===a[a.length-1]&&(a=a.substr(0,a.length-2)),a+"}")}),"_cToJsonStr");function i(e){return!0!==e&&!1!==e&&isNaN(e)?'"'+e+'"':e}y(i,"stringval"),e.convertToJsonString=a}}),S=m({"../../node_modules/.pnpm/fast-xml-parser@3.19.0/node_modules/fast-xml-parser/src/json2xml.js":function(e,t){var r=A().buildOptions,n={attributeNamePrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataTagName:!1,cdataPositionChar:"\\c",format:!1,indentBy:"  ",supressEmptyNode:!1,tagValueProcessor:y((function(e){return e}),"tagValueProcessor"),attrValueProcessor:y((function(e){return e}),"attrValueProcessor")},a=["attributeNamePrefix","attrNodeName","textNodeName","ignoreAttributes","cdataTagName","cdataPositionChar","format","indentBy","supressEmptyNode","tagValueProcessor","attrValueProcessor"];function o(e){this.options=r(e,n,a),this.options.ignoreAttributes||this.options.attrNodeName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=p),this.options.cdataTagName?this.isCDATA=h:this.isCDATA=function(){return!1},this.replaceCDATAstr=i,this.replaceCDATAarr=s,this.options.format?(this.indentate=d,this.tagEndChar=">\n",this.newLine="\n"):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine=""),this.options.supressEmptyNode?(this.buildTextNode=f,this.buildObjNode=l):(this.buildTextNode=c,this.buildObjNode=u),this.buildTextValNode=c,this.buildObjectNode=u}function i(e,t){return e=this.options.tagValueProcessor(""+e),""===this.options.cdataPositionChar||""===e?e+"<![CDATA["+t+"]]"+this.tagEndChar:e.replace(this.options.cdataPositionChar,"<![CDATA["+t+"]]"+this.tagEndChar)}function s(e,t){if(e=this.options.tagValueProcessor(""+e),""===this.options.cdataPositionChar||""===e)return e+"<![CDATA["+t.join("]]><![CDATA[")+"]]"+this.tagEndChar;for(var r in t)e=e.replace(this.options.cdataPositionChar,"<![CDATA["+t[r]+"]]>");return e+this.newLine}function u(e,t,r,n){return r&&!e.includes("<")?this.indentate(n)+"<"+t+r+">"+e+"</"+t+this.tagEndChar:this.indentate(n)+"<"+t+r+this.tagEndChar+e+this.indentate(n)+"</"+t+this.tagEndChar}function l(e,t,r,n){return""!==e?this.buildObjectNode(e,t,r,n):this.indentate(n)+"<"+t+r+"/"+this.tagEndChar}function c(e,t,r,n){return this.indentate(n)+"<"+t+r+">"+this.options.tagValueProcessor(e)+"</"+t+this.tagEndChar}function f(e,t,r,n){return""!==e?this.buildTextValNode(e,t,r,n):this.indentate(n)+"<"+t+r+"/"+this.tagEndChar}function d(e){return this.options.indentBy.repeat(e)}function p(e){return!!e.startsWith(this.options.attributeNamePrefix)&&e.substr(this.attrPrefixLen)}function h(e){return e===this.options.cdataTagName}y(o,"Parser"),o.prototype.parse=function(e){return this.j2x(e,0).val},o.prototype.j2x=function(e,t){for(var r="",n="",a=Object.keys(e),o=a.length,i=0;i<o;i++){var s=a[i];if(void 0===e[s]);else if(null===e[s])n+=this.indentate(t)+"<"+s+"/"+this.tagEndChar;else if(_instanceof(e[s],Date))n+=this.buildTextNode(e[s],s,"",t);else if("object"!==_type_of(e[s])){var u=this.isAttribute(s);u?r+=" "+u+'="'+this.options.attrValueProcessor(""+e[s])+'"':this.isCDATA(s)?e[this.options.textNodeName]?n+=this.replaceCDATAstr(e[this.options.textNodeName],e[s]):n+=this.replaceCDATAstr("",e[s]):s===this.options.textNodeName?e[this.options.cdataTagName]||(n+=this.options.tagValueProcessor(""+e[s])):n+=this.buildTextNode(e[s],s,"",t)}else if(Array.isArray(e[s]))if(this.isCDATA(s))n+=this.indentate(t),e[this.options.textNodeName]?n+=this.replaceCDATAarr(e[this.options.textNodeName],e[s]):n+=this.replaceCDATAarr("",e[s]);else for(var l=e[s].length,c=0;c<l;c++){var f=e[s][c];if(void 0===f);else if(null===f)n+=this.indentate(t)+"<"+s+"/"+this.tagEndChar;else if("object"===(void 0===f?"undefined":_type_of(f))){var d=this.j2x(f,t+1);n+=this.buildObjNode(d.val,s,d.attrStr,t)}else n+=this.buildTextNode(f,s,"",t)}else if(this.options.attrNodeName&&s===this.options.attrNodeName)for(var p=Object.keys(e[s]),h=p.length,_=0;_<h;_++)r+=" "+p[_]+'="'+this.options.attrValueProcessor(""+e[s][p[_]])+'"';else{var g=this.j2x(e[s],t+1);n+=this.buildObjNode(g.val,s,g.attrStr,t)}}return{attrStr:r,val:n}},y(i,"replaceCDATAstr"),y(s,"replaceCDATAarr"),y(u,"buildObjectNode"),y(l,"buildEmptyObjNode"),y(c,"buildTextValNode"),y(f,"buildEmptyTextNode"),y(d,"indentate"),y(p,"isAttribute"),y(h,"isCDATA"),t.exports=o}}),I=m({"../../node_modules/.pnpm/fast-xml-parser@3.19.0/node_modules/fast-xml-parser/src/parser.js":function(e){var t=E(),r=T(),n=T(),a=A().buildOptions,o=w();e.parse=function(e,i,s){if(s){!0===s&&(s={});var u=o.validate(e,s);if(!0!==u)throw Error(u.err.msg)}i=a(i,n.defaultOptions,n.props);var l=r.getTraversalObj(e,i);return t.convertToJson(l,i)},e.convertTonimn=x().convert2nimn,e.getTraversalObj=r.getTraversalObj,e.convertToJson=t.convertToJson,e.convertToJsonString=P().convertToJsonString,e.validate=o.validate,e.j2xParser=S(),e.parseToNimn=function(t,r,n){return e.convertTonimn(e.getTraversalObj(t,n),r,n)}}}),j={};!function(e,t){for(var r in t)p(e,r,{get:t[r],enumerable:!0})}(j,{APIS:function(){return R},BlockNOS:function(){return be},BlockNOSWeb:function(){return we},ConcurrentNOS:function(){return Ne},ConcurrentNOSWeb:function(){return xe},ERROR_CODE_MAP:function(){return X},NOS:function(){return me},NOSBlockUploader:function(){return te},NOSClass:function(){return B},NOSConcurrentUploader:function(){return ue},NOSDefaultUploader:function(){return $},NOSUploader:function(){return Q},NOSWeb:function(){return Te},NOSWebClass:function(){return Ce},NosSDKError:function(){return J},RichMediaQueries:function(){return _e},RichMediaURL:function(){return ye},WebAdapter:function(){return ke}});var U={NOS_UPLOAD:{url:"https://nos.netease.com/{bucketName}",method:"POST"},NOS_GET_OBJECT:{url:"https://nos.netease.com/{bucketName}/{objectKey}"},NOS_BLOCK_UPLOAD:{url:"https://nosup-hz1.127.net/{bucketName}/{objectKey}",method:"POST"},FETCH_BLOCK_UPLOAD_CONTEXT:{url:"https://nosup-hz1.127.net/{bucketName}/{objectKey}",method:"GET"},FETCH_BLOCK_UPLOAD_SERVER:{url:"https://nos.netease.com/lbs",method:"GET"},NOS_CONCURRENT_UPLOAD:{url:"https://nosup-hz1.127.net/{bucketName}/{objectKey}"}},R={default:U,jd:{NOS_UPLOAD:{url:"https://nos.netease.com/{bucketName}",method:"POST"},NOS_GET_OBJECT:{url:"https://nos.netease.com/{bucketName}/{objectKey}"},NOS_BLOCK_UPLOAD:{url:"https://nosup-jd1.127.net/{bucketName}/{objectKey}",method:"POST"},FETCH_BLOCK_UPLOAD_CONTEXT:{url:"https://nosup-jd1.127.net/{bucketName}/{objectKey}",method:"GET"},FETCH_BLOCK_UPLOAD_SERVER:{url:"https://nos.netease.com/lbs",method:"GET"},NOS_CONCURRENT_UPLOAD:{url:"https://nosup-jd1.127.net/{bucketName}/{objectKey}"}}},F=U,L=function(){function e(t){_class_call_check(this,e),O(this,"Uploader"),O(this,"_apis",F),O(this,"uploadAdapter",null),O(this,"fetchAdapter",null),O(this,"storage"),O(this,"getNOSToken",null),this.Uploader=t}return _create_class(e,[{key:"useAdapter",value:function(e){this.uploadAdapter=e}},{key:"useFetchAdapter",value:function(e){this.fetchAdapter=e}},{key:"useGetToken",value:function(e){this.getNOSToken=e}},{key:"updateAPI",value:function(e){this._apis=_object_spread({},this._apis,e)}},{key:"isNOSObject",value:function(e){var t=this._apis.NOS_GET_OBJECT,r=t&&t.url;if(!r)throw new Error("NOS_GET_OBJECT not found");return new RegExp("^".concat(r.replace(/{\w+}/g,"\\w+"))).test(e)}},{key:"createUploadTask",value:function(e,t,r){if(!this.uploadAdapter)throw new Error("uploader adapter not found");if(!this.getNOSToken&&!t)throw new Error("getNotToken adapter or uploaderSignature not found");if(!this.fetchAdapter)throw new Error("fetchAdapter adapter not found");return new this.Uploader({apis:this._apis,file:e,adapter:this.uploadAdapter,getNOSToken:this.getNOSToken,uploaderSignature:t,fetchAdapter:this.fetchAdapter,uploadOptions:r,storage:this.storage})}}]),e}();y(L,"NOSClass");var B=L,D=N(k());y(e,"spread");var M=function e(t){_class_call_check(this,e),O(this,"data"),O(this,"target"),O(this,"type");var r=t.data,n=t.target,a=t.type;return this.data=r,this.target=n,this.type=a,this};y(M,"Event"),O(M,"isEvent",y((function(e){return e&&_instanceof(e,M)}),"isEvent"));var K=M,V=function(){function t(){_class_call_check(this,t),O(this,"_events"),O(this,"_destroyed"),O(this,"_batch",!1),O(this,"_paddingEvents",[]),this._events={},this._destroyed=!1}return _create_class(t,[{key:"emit",value:function(e,t){var r;if(r=K.isEvent(e)?e:new K({target:this,data:t,type:e}),this._batch)this.addPaddingEvent(r);else{var n=r.type,a=this._events[n];a&&a.forEach((function(e){e(r)}))}}},{key:"batchEmit",value:function(e){this._batch=!0,e(),this._batch=!1,this.runPaddingEvents()}},{key:"addPaddingEvent",value:function(e){this._paddingEvents.push(e)}},{key:"runPaddingEvents",value:function(){var e=this._paddingEvents,t={};for(var r in e.forEach((function(e){t[e.type]=e})),t)t[r]&&this.emit(t[r]);this._paddingEvents=[]}},{key:"addListener",value:function(e,t){var r=this,n=y((function(){}),"removeListener");if(this._destroyed)return n;if(t){var a=this._events[e];a||(a=[],this._events[e]=a),a.push(t)}return t&&(n=y((function(){r.removeListener(t)}),"removeListener")),n}},{key:"removeListener",value:function(e,t){var r,n,a=this;if(!this._destroyed)if("string"==typeof e?(r=e,n=t):n=e,r){var o=this._events;o[r]&&this._remove(o[r],n)}else{var i=this._events;Object.keys(i).forEach((function(e){a._remove(i[e],n)}))}}},{key:"_remove",value:function(e,t){var r=e.findIndex((function(e){return e===t}));r>-1&&e.splice(r,1)}},{key:"destroy",value:function(){e("willDestroy",this),this._events={},this._destroyed=!0,e("didDestroy",this)}}]),t}();y(V,"EventEmitter");var z=V,G=function(){function e(t,r,n){var a;return _class_call_check(this,e),a=_call_super(this,e,[r]),O(a,"name","NosSDKError"),O(a,"code"),O(a,"more"),a.code=t,a.more=n,a}return _inherits(e,_wrap_native_super(Error)),e}();y(G,"NosSDKError");var J=G,X={GET_TOKEN_FAIL:{code:100,message:"get NOS token fail"},DEFAULT_UPLOAD_FAIL:{code:1e3,message:""},BLOCK_RETRIES_EXCEEDED:{code:2e3,message:"upload error: retries have exceeded the limit."},BLOCK_FETCH_OFFSET_FAIL:{code:2001,message:"upload error: retries have exceeded the limit."},CONCURRENT_GET_UPLOAD_ID_FAIL:{code:3e3,message:""},CONCURRENT_GET_BLOCK_MD5_FAIL:{code:3001,message:""},CONCURRENT_GET_COMPLETE_ALL_BLOCKS_FAIL:{code:3002,message:""},CONCURRENT_RETRIES_EXCEEDED:{code:3003,message:"upload error: retries have exceeded the limit."}};y(t,"log"),y(r,"logTime"),y(n,"logTimeEnd");var H=0,q=function(e){function a(e){var t,r=e.apis,n=e.adapter,o=e.file,i=e.getNOSToken,s=e.uploaderSignature,u=e.fetchAdapter,l=e.uploadOptions,c=e.storage;return _class_call_check(this,a),t=_call_super(this,a),O(t,"id",++H),O(t,"_adapter"),O(t,"_fetchAdapter"),O(t,"storage"),O(t,"_originFile"),O(t,"_getNOSToken"),O(t,"_apis"),O(t,"uploadError"),O(t,"uploadInfo",{percent:0,timestamp:(new Date).getTime()}),O(t,"uploadedInfo"),O(t,"type"),O(t,"signature"),O(t,"fileKey"),O(t,"fileKeyPrefix",""),O(t,"_uploadOptions"),O(t,"_paused",!1),t._apis=r,t._adapter=n,t._originFile=o,i&&(t._getNOSToken=i),s&&(t.signature=s),t._fetchAdapter=u,t._uploadOptions=l,t.storage=c,t.fileKey=t.createFileKey(),t}return _inherits(a,e),_create_class(a,[{key:"createFileKey",value:function(){var e=this._originFile,t="".concat(this.fileKeyPrefix,"_").concat(e.name,"_").concat(e.size,"_").concat(e.lastModified);return D.default.hash(t)}},{key:"paused",get:function(){return this._paused}},{key:"getNOSTokenFromRemote",value:function(){var e=this;return _async_to_generator((function(){var t;return _ts_generator(this,(function(r){switch(r.label){case 0:return e._getNOSToken?[4,e._getNOSToken(e)]:[3,2];case 1:t=r.sent(),r.label=2;case 2:return[2,t]}}))}))()}},{key:"getNOSToken",value:function(){var e=this;return _async_to_generator((function(){var t,r,n;return _ts_generator(this,(function(a){switch(a.label){case 0:if(t=e.signature)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,e.getNOSTokenFromRemote()];case 2:return t=a.sent(),[3,4];case 3:throw r=a.sent(),e.setError(new J(X.GET_TOKEN_FAIL.code,X.GET_TOKEN_FAIL.message)),r;case 4:if(!t)throw n=new J(X.GET_TOKEN_FAIL.code,X.GET_TOKEN_FAIL.message),e.setError(n),n;return e.emit("getToken",t),[2,t]}}))}))()}},{key:"setComplete",value:function(){this.uploadInfo.percent=1,this.uploadedInfo={objectKey:this.signature.objectKey,bucketName:this.signature.bucketName},this.emit("complete",this.uploadedInfo)}},{key:"isCompleted",value:function(){return!!this.uploadedInfo}},{key:"setError",value:function(e){this.uploadError=e,this.emit("error",e)}},{key:"clearError",value:function(){delete this.uploadError}},{key:"updateProgress",value:function(e){this.uploadInfo={percent:e.percent,sent:e.sent,total:e.total,timestamp:(new Date).getTime()},this.emit("progress",this.uploadInfo)}},{key:"generateFileMD5",value:function(){var e=this;return new Promise((function(a,o){var i=function(){return p.apply(this,arguments)},s=e._originFile;if(!s)throw new Error("no file");r("md5");var u=4194304,l=Math.ceil(s.size/u),c=0,f=new D.default.ArrayBuffer,d=new FileReader;function p(){return(p=_async_to_generator((function(){var e,t;return _ts_generator(this,(function(r){return t=(e=c*u)+u>=s.size?s.size:e+u,d.readAsArrayBuffer(s.slice(e,t)),[2]}))}))).apply(this,arguments)}y(i,"loadNext"),d.onload=function(e){var r,o=null===(r=e.target)||void 0===r?void 0:r.result;if(o&&f.append(o),++c<l)i();else{var u=f.end();t("md5 计算完成",u,s.name,new Date),n("md5"),a(u)}},d.onerror=function(e){o(e)},i()}))}},{key:"destroy",value:function(){_get(_get_prototype_of(a.prototype),"destroy",this).call(this),this.uploadedInfo||this.abort()}}]),a}(z);y(q,"NOSUploader");var Q=q,W=function(e){function t(){var e;return _class_call_check(this,t),e=_call_super(this,t,arguments),O(e,"_abort"),e}return _inherits(t,e),_create_class(t,[{key:"pause",value:function(){var e=this;return _async_to_generator((function(){return _ts_generator(this,(function(t){return e._paused=!0,e._abort&&e._abort(),[2]}))}))()}},{key:"abort",value:function(){var e=this;return _async_to_generator((function(){return _ts_generator(this,(function(t){return e.pause(),[2]}))}))()}},{key:"upload",value:function(){var e=this;return _async_to_generator((function(){var t,r;return _ts_generator(this,(function(n){switch(n.label){case 0:return e._paused=!1,[4,e.getNOSToken()];case 1:return t=n.sent(),r=e._apis.NOS_UPLOAD.url.replace(/\{(\w+)\}/g,(function(e,r){return t[r]||""})),e.signature=t,[2,new Promise((function(n,a){var o,i=e._adapter({url:r,fileKey:"file",type:"form",file:e._originFile,headers:_object_spread({"x-nos-token":t.token},(null===(o=e._uploadOptions)||void 0===o?void 0:o.headers)||{}),data:{Object:t.objectKey,"x-nos-token":t.token},success:y(function(){var t=_async_to_generator((function(t){return _ts_generator(this,(function(t){switch(t.label){case 0:return[4,e.setComplete()];case 1:return t.sent(),n(e.uploadedInfo),[2]}}))}));return function(e){return t.apply(this,arguments)}}(),"success"),error:y((function(t){var r=new J(X.DEFAULT_UPLOAD_FAIL.code,X.DEFAULT_UPLOAD_FAIL.message,{custom:t});e.setError(r),a(r)}),"error"),progress:y((function(t){e.updateProgress(t)}),"progress")}).abort;e._abort=i}))]}}))}))()}}]),t}(Q);y(W,"NOSDefaultUploader");var $=W,Y=10485760;y(a,"urlReplace"),y(o,"fileSlice");var Z={},ee=function(e){function r(){var e;return _class_call_check(this,r),e=_call_super(this,r,arguments),O(e,"_abort"),O(e,"blockSize",Y),O(e,"shouldUpdateProgressFromBlockUploading",!0),O(e,"blockUploadInfo",{offset:0,context:""}),O(e,"retryCount",0),e}return _inherits(r,e),_create_class(r,[{key:"pause",value:function(){return this._paused=!0,this._abort&&this._abort(),this.clearRetry(),Promise.resolve()}},{key:"paused",get:function(){return this._paused}},{key:"abort",value:function(){var e=this;return _async_to_generator((function(){return _ts_generator(this,(function(t){switch(t.label){case 0:return[4,e.pause()];case 1:return t.sent(),e.removeBlockContext(),[2]}}))}))()}},{key:"upload",value:function(){var e=this;return _async_to_generator((function(){var t;return _ts_generator(this,(function(r){switch(r.label){case 0:return e._paused=!1,[4,e.fetchUnCompleteBlobBlockInfo()];case 1:return(t=r.sent())?[3,3]:[4,e.getNOSToken()];case 2:return e.signature=r.sent(),[3,4];case 3:e.signature=t.signature,r.label=4;case 4:return[4,e.fetchUploadOffsetFromRemote()];case 5:return r.sent(),[2,e.startBlockUpload()]}}))}))()}},{key:"clearRetry",value:function(){this.retryCount=0}},{key:"createRetry",value:function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,a=this;return function(){for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];var u;if(a.retryCount>=n){t("retry too much");var l=new J(X.BLOCK_RETRIES_EXCEEDED.code,X.BLOCK_RETRIES_EXCEEDED.message,{custom:r});return a.setError(l),Promise.reject(l)}return a.retryCount+=1,(u=e).call.apply(u,[a].concat(_to_consumable_array(i)))}}},{key:"updateBlockProgress",value:function(e){this.blockUploadInfo={offset:e.offset,context:e.context},this.saveBlockContext()}},{key:"updateProgressFromBlock",value:function(e){if(this.shouldUpdateProgressFromBlockUploading){var t=this.blockUploadInfo.offset,r=e.sent;if(r){var n=t+r;this.updateProgress({percent:Math.min(1,n/this._originFile.size),total:this._originFile.size,sent:n})}}}},{key:"saveBlockContext",value:function(){this.blockUploadInfo.context&&this.signature&&this.storage&&this.storage.set(this.fileKey,{context:this.blockUploadInfo.context,signature:this.signature})}},{key:"removeBlockContext",value:function(){delete this.signature,this.updateBlockProgress({offset:0,context:""}),this.storage&&this.storage.remove(this.fileKey)}},{key:"fetchBlockUploadServer",value:function(){if(!this.signature)return Promise.reject();var e=this.signature;Z[e.bucketName]||(Z[e.bucketName]={index:0,lbs:this._fetchAdapter({url:"".concat(this._apis.FETCH_BLOCK_UPLOAD_SERVER.url,"?version=1.0&bucketname=").concat(e.bucketName),method:"GET",headers:{"x-nos-token":e.token}}).then((function(e){return e.body.upload}))});var t=Z[e.bucketName];return t.lbs.then((function(e){var r=e[t.index],n=t.index+1;return n===e.length&&(n=0),t.index=n,r.replace("http://","https://")}))}},{key:"fetchUploadOffsetFromRemote",value:function(){var e=this,t=this.signature;if(!t)throw new Error;if(!this.blockUploadInfo.context)return Promise.resolve();var r=this._apis.FETCH_BLOCK_UPLOAD_CONTEXT.url.replace(/\{(\w+)\}/g,(function(e,r){return t[r]||""}));return r+="?uploadContext&version=1.0&context=".concat(this.blockUploadInfo.context),this._fetchAdapter({url:r,method:"GET",headers:{"x-nos-token":t.token}}).then((function(t){var r=t.body;r.errCode?(e.removeBlockContext(),e.setError(new J(X.BLOCK_FETCH_OFFSET_FAIL.code,r.errMsg,{errCode:r.errCode,errMsg:r.errMsg}))):e.updateBlockProgress({offset:r.offset,context:e.blockUploadInfo.context})}),(function(){e.removeBlockContext()}))}},{key:"uploadNextBlock",value:function(){var e=this;return _async_to_generator((function(){var r,n,i,s,u,l,c,f,d,p,h;return _ts_generator(this,(function(_){if(!e.signature)throw new Error("signature not");return r=e._originFile,n=e.signature,i=e.blockUploadInfo,s=i.offset,u=void 0===s?0:s,l=i.context,c=o(r,u,e.blockSize),t("blobBlock",c,u),f=u+c.size>=r.size,d=a(e._apis.NOS_BLOCK_UPLOAD.url,e.signature),p={offset:u,complete:f,context:l,version:"1.0"},h=Object.keys(p).map((function(e){return"".concat(e,"=").concat(p[e])})),d+="?".concat(h.join("&")),[2,new Promise((function(t,r){var a,o=e._adapter({url:d,file:c,type:"blob",fileKey:"file",headers:_object_spread({"x-nos-token":n.token},(null===(a=e._uploadOptions)||void 0===a?void 0:a.headers)||{}),timeout:18e5,success:y((function(e){if(e.errCode)r(e);else{var n=e.body;t(n)}}),"success"),error:y((function(e){r(e)}),"error"),progress:y((function(t){e.updateProgressFromBlock(t)}),"progress")}).abort;e._abort=o}))]}))}))()}},{key:"isAllBlockCompleted",value:function(){return this.blockUploadInfo.offset>=this._originFile.size}},{key:"startBlockUpload",value:function(){var e=this;if(this.paused)return Promise.reject("paused");var t=this;return this.uploadNextBlock().then(function(){var e=_async_to_generator((function(e){return _ts_generator(this,(function(r){switch(r.label){case 0:return t.clearRetry(),t.updateBlockProgress(e),t.updateProgress({percent:Math.min(1,e.offset/t._originFile.size),total:t._originFile.size,sent:e.offset}),t.isAllBlockCompleted()?[4,t.setComplete()]:[3,3];case 1:return r.sent(),[4,t.removeBlockContext()];case 2:return r.sent(),[2,t.uploadedInfo];case 3:return[2,t.startBlockUpload()]}}))}));return function(t){return e.apply(this,arguments)}}(),(function(t){return e.createRetry(e.startBlockUpload,t)()}))}},{key:"fetchUnCompleteBlobBlockInfo",value:function(){return this.signature?{signature:this.signature}:this.storage&&this.storage.get(this.fileKey)}}]),r}(Q);y(ee,"NOSBlockUploader");var te=ee,re=N(k()),ne=N(I()),ae=0,oe=1,ie=2,se=function(e){function i(){var e;return _class_call_check(this,i),e=_call_super(this,i,arguments),O(e,"blockSize",Y),O(e,"maxRetry",4),O(e,"shouldUpdateProgressFromBlockUploading",!0),O(e,"retryCount",0),O(e,"uploadId"),O(e,"partsInfo",[]),O(e,"getUploadId",y((function(){if(!e.signature)throw new Error("nos signature not found");return e._fetchAdapter({url:e.getRemoteInitUrl(),method:"POST",responseType:"text",headers:{"x-nos-token":e.signature.token}}).then((function(t){t.headers;var r=t.body;if(!r){var n=new J(X.CONCURRENT_GET_UPLOAD_ID_FAIL.code,X.CONCURRENT_GET_UPLOAD_ID_FAIL.message);throw e.setError(n),n}try{var a=(0,ne.parse)(r,{ignoreNameSpace:!0,parseTrueNumberOnly:!0},!0);e.uploadId=a.InitiateMultipartUploadResult.UploadId,e.storage&&e.storage.set(e.fileKey,{uploadId:e.uploadId,size:e.blockSize,signature:e.signature})}catch(t){var o=new J(X.CONCURRENT_GET_UPLOAD_ID_FAIL.code,X.CONCURRENT_GET_UPLOAD_ID_FAIL.message,{custom:t});throw e.setError(o),o}}),(function(t){var r=new J(X.CONCURRENT_GET_UPLOAD_ID_FAIL.code,X.CONCURRENT_GET_UPLOAD_ID_FAIL.message,{custom:t});throw e.setError(r),r}))}),"getUploadId")),O(e,"abortRemote",y((function(){if(!e.signature)throw new Error;var t=e.signature.token;return delete e.signature,delete e.uploadId,e._fetchAdapter({url:e.getRemoteUrl(),method:"DELETE",headers:{"x-nos-token":t},responseType:"text"})}),"abortRemote")),O(e,"uploadingAbort",{}),O(e,"initParts",y((function(){for(var t=[],r=Math.ceil(e._originFile.size/e.blockSize),n=0;n<r;n++){var a=e.blockSize;n===r-1&&(a=e._originFile.size%e.blockSize),t.push({partNumber:n+1,partStatus:ae,partSize:a})}e.partsInfo=t}),"initParts")),O(e,"checkParts",y((function(){return e._fetchAdapter({url:e.getRemoteUrl(),method:"GET",headers:{"x-nos-token":e.signature.token},responseType:"text"}).then((function(t){var r=t.body;if(!r)return Promise.reject();var n=(0,ne.parse)(r,{ignoreNameSpace:!0},!0);return n.ListPartsResult.Part.length?e.batchEmit((function(){n.ListPartsResult.Part.forEach((function(t){e.updatePartInfo({partNumber:t.PartNumber,partStatus:ie,md5:t.ETag})}))})):e.updatePartInfo({partNumber:n.ListPartsResult.Part.PartNumber,md5:n.ListPartsResult.Part.ETag,partStatus:ie}),Promise.resolve()}))}),"checkParts")),e}return _inherits(i,e),_create_class(i,[{key:"abort",value:function(){var e=this;return _async_to_generator((function(){return _ts_generator(this,(function(t){switch(t.label){case 0:return[4,e.pause()];case 1:return t.sent(),e.abortRemote(),[2]}}))}))()}},{key:"pause",value:function(){for(var e in this._paused=!0,this.uploadingAbort)Object.prototype.hasOwnProperty.call(this.uploadingAbort,e)&&this.uploadingAbort[e]();return Promise.resolve()}},{key:"upload",value:function(){var e=this;return _async_to_generator((function(){var n,a;return _ts_generator(this,(function(o){switch(o.label){case 0:return r("upload"),e._paused=!1,e.clearRetry(),e.clearError(),[4,e.initParts()];case 1:return o.sent(),[4,e.fetchUnCompleteUploadInfo()];case 2:return(n=o.sent())?[3,5]:[4,e.getNOSToken()];case 3:return e.signature=o.sent(),[4,e.getUploadId()];case 4:return o.sent(),[3,11];case 5:e.signature=n.signature,e.uploadId=n.uploadId,o.label=6;case 6:return o.trys.push([6,8,,11]),[4,e.checkParts()];case 7:return o.sent(),[3,11];case 8:return a=o.sent(),t("checkParts fail",a),delete e.signature,delete e.uploadId,e.storage&&e.storage.remove(e.fileKey),[4,e.getNOSToken()];case 9:return e.signature=o.sent(),[4,e.getUploadId()];case 10:return o.sent(),[3,11];case 11:return[2,e.startBlockUpload()]}}))}))()}},{key:"uploadingPartCount",get:function(){return this.partsInfo.filter((function(e){return e.partStatus===oe})).length}},{key:"uploadedPartCount",get:function(){return this.partsInfo.filter((function(e){return e.partStatus===ie})).length}},{key:"clearRetry",value:function(){this.retryCount=0}},{key:"allowRetry",value:function(){return this.retryCount<=4}},{key:"allowUploadNew",value:function(){return!this._paused&&this.uploadingPartCount<6}},{key:"getRemoteInitUrl",value:function(){if(!this.signature)throw new Error;var e=a(this._apis.NOS_CONCURRENT_UPLOAD.url,this.signature);return"".concat(e,"?uploads")}},{key:"getRemoteUrl",value:function(e){if(!this.signature)throw new Error;var t="".concat(a(this._apis.NOS_CONCURRENT_UPLOAD.url,this.signature),"?");return e&&(t+=Object.keys(e).map((function(t){return"".concat(t,"=").concat(encodeURIComponent(e[t]))})).join("&"),t+="&"),t+="uploadId=".concat(this.uploadId)}},{key:"updatePartInfo",value:function(e){var t=this.partsInfo,r=e.partNumber-1;t[r]=_object_spread({},t[r],e);var n=t.reduce((function(e,t){return e+(t.partStatus===ie?t.partSize:t.partSent||0)}),0);this.updateProgress({percent:Math.min(1,n/this._originFile.size),total:this._originFile.size,sent:n})}},{key:"uploadPart",value:function(e){var t=this;return _async_to_generator((function(){var r,n;return _ts_generator(this,(function(a){switch(a.label){case 0:return r=o(t._originFile,t.blockSize*(e-1),t.blockSize),[4,new Promise((function(e,n){var a=new FileReader;a.readAsArrayBuffer(r),a.onload=function(t){var r,n=new re.default.ArrayBuffer;n.append(null===(r=t.target)||void 0===r?void 0:r.result),e(n.end())},a.onerror=function(e){var r=new J(X.CONCURRENT_GET_BLOCK_MD5_FAIL.code,X.CONCURRENT_GET_BLOCK_MD5_FAIL.message);t.setError(r),n(r)}}))];case 1:return n=a.sent(),[2,new Promise((function(a,o){var i=t._adapter({url:t.getRemoteUrl({partNumber:e}),file:r,method:"PUT",type:"blob",fileKey:"file",responseType:"text",headers:{"Content-MD5":n,"x-nos-token":t.signature.token},timeout:18e5,success:y((function(r){delete t.uploadingAbort[e],r.errCode?o("nos error"):a(n)}),"success"),error:y((function(){delete t.uploadingAbort[e],o("network")}),"error"),progress:y((function(r){t.updateProgressFromBlock(e,r)}),"progress")}).abort;t.uploadingAbort[e]=i}))]}}))}))()}},{key:"completeAllParts",value:function(){var e,r,a=this,o={CompleteMultipartUpload:{Part:this.partsInfo.map((function(e){return{PartNumber:e.partNumber,ETag:e.md5}}))}},i=new ne.j2xParser({}).parse(o);this._fetchAdapter({url:this.getRemoteUrl(),method:"POST",responseType:"text",headers:_object_spread({"Content-Type":"text/xml","x-nos-token":null===(e=this.signature)||void 0===e?void 0:e.token},(null===(r=this._uploadOptions)||void 0===r?void 0:r.headers)||{}),body:i}).then((function(e){e.headers,e.body;a.storage&&a.storage.remove(a.fileKey),n("upload"),a.setComplete(),t("upload success",a._originFile.name,new Date)}),(function(e){e.status>0&&a.storage&&a.storage.remove(a.fileKey),a.setError(new J(X.CONCURRENT_GET_COMPLETE_ALL_BLOCKS_FAIL.code,X.CONCURRENT_GET_COMPLETE_ALL_BLOCKS_FAIL.message))}))}},{key:"checkAllPartCompleted",value:function(){return this.partsInfo.every((function(e){return e.partStatus===ie}))}},{key:"updateProgressFromBlock",value:function(e,t){this.shouldUpdateProgressFromBlockUploading&&this.updatePartInfo({partNumber:e,partSent:t.sent||0})}},{key:"getNextPaddingPartInfo",value:function(){return this.partsInfo.find((function(e){return e.partStatus===ae}))}},{key:"uploadNextBlock",value:function(){var e=this;if(this.allowUploadNew())if(this.allowRetry()){var t=this.getNextPaddingPartInfo();if(t){var r=t.partNumber;this.updatePartInfo({partNumber:r,partStatus:oe}),this.uploadPart(t.partNumber).then((function(t){e.updatePartInfo({md5:t,partNumber:r,partStatus:ie}),e.clearRetry(),e.checkAllPartCompleted()?e.completeAllParts():e.uploadNextBlock()}),(function(t){e.updatePartInfo({partNumber:r,partStatus:ae}),!e._paused&&e.allowRetry()&&(e.retryCount++,e.uploadNextBlock())})),this.uploadNextBlock()}}else this.setError(new J(X.CONCURRENT_RETRIES_EXCEEDED.code,X.CONCURRENT_RETRIES_EXCEEDED.message))}},{key:"startBlockUpload",value:function(){var e=this;return this._paused?Promise.reject("paused"):(this.checkAllPartCompleted()?this.completeAllParts():this.uploadNextBlock(),new Promise((function(t,r){e.addListener("complete",(function(){t(e.uploadedInfo)})),e.addListener("error",(function(){r(e.uploadError)}))})))}},{key:"fetchUnCompleteUploadInfo",value:function(){return this.signature&&this.uploadId?{signature:this.signature,uploadId:this.uploadId}:this.storage&&this.storage.get(this.fileKey)}}]),i}(Q);y(se,"NOSConcurrentUploader");var ue=se,le=function(){function e(t){_class_call_check(this,e),O(this,"queryObj",{}),O(this,"operateType",""),this.queryObj=t}return _create_class(e,[{key:"get",value:function(e){return this.queryObj[e]}},{key:"set",value:function(e,t){void 0===t?delete this.queryObj[e]:this.queryObj[e]=t}},{key:"toString",value:function(){var e=this.queryObj;return[this.operateType].concat(_to_consumable_array(Object.keys(e).map((function(t){return!0===e[t]?t:"".concat(t,"=").concat(encodeURIComponent(e[t]))})))).join("&")}}]),e}();y(le,"BaseMediaQuery");var ce=le,fe=function(e){function t(){var e;return _class_call_check(this,t),e=_call_super(this,t,arguments),O(e,"operateType","imageView"),e}return _inherits(t,e),_create_class(t,[{key:"setThumbnail",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.width,r=void 0===t?0:t,n=e.height,a=void 0===n?0:n,o=e.type,i=void 0===o?"x":o;this.set("thumbnail","".concat(r).concat(i).concat(a))}},{key:"setAxis",value:function(e){var t=e.x,r=e.y;this.set("axis","".concat(t,"_").concat(r))}}]),t}(ce);y(fe,"ImageViewMediaQuery");var de=fe,pe=function(e){function t(){var e;return _class_call_check(this,t),e=_call_super(this,t,arguments),O(e,"operateType","watermark"),e}return _inherits(t,e),t}(ce);y(pe,"WatermarkMediaQuery");var he=pe,_e={imageView:de,watermark:he,base:ce},ge=y((function(e){var t=e.split("&"),r={};t.forEach((function(e){var t=_to_array(e.split("=")),n=t[0],a=t.slice(1);a.length>0?r[n]=decodeURIComponent(a.join("=")):r[n]=!0}));var n="";return Object.keys(_e).forEach((function(e){r[e]&&(n=e,delete r[e])})),{operateType:n,query:r}}),"parse");y(i,"createMediaQuery"),y(s,"arrayFindLast");var ve=function(){function e(t){_class_call_check(this,e),O(this,"path",""),O(this,"mediaQueries",[]),this.parse(t)}return _create_class(e,[{key:"parse",value:function(e){var t=_sliced_to_array(e.split("?"),2),r=t[0],n=t[1],a=(n=n||"").split(/\||%7C/).map((function(e){return i(e)})).filter((function(e){return!!e}));this.path=r,this.mediaQueries=a}},{key:"toString",value:function(){var e=this.path,t=this.mediaQueries;return"".concat(e,"?").concat(t.map((function(e){return e.toString()})).join("%7C"))}},{key:"imageView",get:function(){var e,t=s(this.mediaQueries,(function(e){return _instanceof(e,de)}));return t?e=t:(e=new de({}),this.mediaQueries=_to_consumable_array(this.mediaQueries).concat([e])),e}},{key:"watermark",get:function(){var e,t=s(this.mediaQueries,(function(e){return _instanceof(e,he)}));return t?e=t:(e=new he({}),this.mediaQueries=_to_consumable_array(this.mediaQueries).concat([e])),e}}]),e}();y(ve,"RichMediaURL");var ye=ve,me=new B($),be=new B(te),Ne=new B(ue);y(u,"createXMLHttpRequest"),y(l,"applyCallback"),y(c,"createAbort"),y(f,"request");var Oe={set:function(e,t){localStorage.setItem(e,JSON.stringify(t))},remove:function(e){localStorage.removeItem(e)},get:function(e){var t=localStorage.getItem(e);return t?JSON.parse(t):null}},ke={uploader:y((function(e){var t,r=e.url,n=e.type,a=e.method,o=e.fileKey,i=e.file,s=e.headers,u=e.data,l=e.responseType,c=e.success,d=e.error,p=e.progress;if("blob"===n)t=i;else{var h=new FormData;u&&Object.keys(u).forEach((function(e){var t=u[e];return h.append(e,t),h}),new FormData),h.append(o,i),t=h}var _=l||"json",g=f({url:r,method:a||"POST",body:t,headers:s,responseType:_,onSuccess:y((function(e){var t=e.xhr,r=t.response;if("json"===_&&"string"==typeof t.response)try{r=JSON.parse(r)}catch(e){}c({status:t.status,headers:t.getAllResponseHeaders(),body:r})}),"onSuccess"),onError:y((function(e){var t=e.xhr,r=t.response;if("json"===_&&"string"==typeof t.response)try{r=JSON.parse(r)}catch(e){}d({status:t.status,headers:t.getAllResponseHeaders(),body:r})}),"onError")});return g.xhr.upload.addEventListener("progress",(function(e){p({percent:e.loaded/e.total,sent:e.loaded,total:e.total})}),!1),g.send(),{abort:y((function(){return g.abort()}),"abort")}}),"uploader"),fetch:y((function(e){var t=e.url,r=e.method,n=e.headers,a=e.body,o=e.responseType;return new Promise((function(e,i){var s=f({url:t,method:r,headers:n,body:a,responseType:o||"json",onSuccess:function(t){var r=t.xhr;e({headers:r.getAllResponseHeaders(),body:r.response||r.responseText})},onError:function(e){var t=e.xhr;i({status:t.status,headers:t.getAllResponseHeaders(),body:t.response||t.responseText})}});return s.send(),{abort:y((function(){return s.abort()}),"abort")}}))}),"fetch"),storage:Oe},Ae=function(e){function t(){var e;return _class_call_check(this,t),e=_call_super(this,t,arguments),O(e,"uploadAdapter",ke.uploader),O(e,"fetchAdapter",ke.fetch),O(e,"storage",ke.storage),e}return _inherits(t,e),t}(B);y(Ae,"NOSWebClass");var Ee,Ce=Ae,Te=new Ce($),we=new Ce(te),xe=new Ce(ue);return Ee=j,b(p({},"__esModule",{value:!0}),Ee)}();